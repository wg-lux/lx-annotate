import{d as w,h as b,e as f,i as x,c as s,a as l,E as M,l as o,j as c,G as u,v as N,F as g,m as y,k as D,H as U,p,t as d,o as i,_ as C}from"./main.js";import{u as F}from"./patientStore.js";const B=["value"],R=["value"],T=["disabled"],A={key:0,class:"alert alert-danger mt-2"},G={key:1,class:"alert alert-success mt-2"},Y=w({__name:"PatientAdder",emits:["patient-created","cancel"],setup(H,{emit:P}){const v=P,a=F(),m=b(""),r=b({firstName:"",lastName:"",dob:null,email:"",phone:"",gender:null,center:null,patientHash:"",comments:"",isRealPerson:!0}),V=f(()=>a.genders),h=f(()=>a.centers),k=()=>{r.value={firstName:"",lastName:"",dob:null,email:"",phone:"",gender:null,center:null,patientHash:"",comments:"",isRealPerson:!0}},E=async()=>{if(a.clearError(),m.value="",!r.value.firstName?.trim()){a.error="Vorname ist erforderlich";return}if(!r.value.lastName?.trim()){a.error="Nachname ist erforderlich";return}try{const n=a.formatPatientForSubmission(r.value),e=await a.createPatient(n);m.value=`Patient "${e.firstName} ${e.lastName}" wurde erfolgreich erstellt!`;try{v("patient-created",e)}catch(t){console.error("Error emitting patient-created event:",t)}k()}catch(n){a.error=n.message||"Fehler beim Erstellen des Patienten",console.error("Error creating patient:",n)}},S=()=>{try{v("cancel")}catch(n){console.error("Error emitting cancel event:",n)}};return x(async()=>{try{if(!a){console.error("PatientStore is not available");return}a.clearError(),await Promise.all([a.fetchGenders(),a.fetchCenters()])}catch(n){console.error("Error loading dropdown data:",n),a?.error!==void 0&&(a.error="Fehler beim Laden der Auswahloptionen")}}),(n,e)=>(i(),s("div",null,[l("form",{onSubmit:M(E,["prevent"])},[e[13]||(e[13]=l("h2",null,"Patientendaten",-1)),e[14]||(e[14]=l("label",{for:"firstName"},"Vorname: *",-1)),o(l("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>r.value.firstName=t),id:"firstName",type:"text",required:"",placeholder:"Vorname eingeben"},null,512),[[u,r.value.firstName]]),e[15]||(e[15]=l("label",{for:"lastName"},"Nachname: *",-1)),o(l("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>r.value.lastName=t),id:"lastName",type:"text",required:"",placeholder:"Nachname eingeben"},null,512),[[u,r.value.lastName]]),e[16]||(e[16]=l("label",{for:"dob"},"Geburtsdatum:",-1)),o(l("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>r.value.dob=t),id:"dob",type:"date",placeholder:"YYYY-MM-DD"},null,512),[[u,r.value.dob]]),e[17]||(e[17]=l("label",{for:"email"},"E-Mail:",-1)),o(l("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>r.value.email=t),id:"email",type:"email",placeholder:"email@beispiel.de"},null,512),[[u,r.value.email]]),e[18]||(e[18]=l("label",{for:"phone"},"Telefon:",-1)),o(l("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>r.value.phone=t),id:"phone",type:"tel",placeholder:"Telefonnummer"},null,512),[[u,r.value.phone]]),l("div",null,[e[9]||(e[9]=l("label",null,"Geschlecht:",-1)),o(l("select",{"onUpdate:modelValue":e[5]||(e[5]=t=>r.value.gender=t),id:"genderSelect"},[e[8]||(e[8]=l("option",{value:""},"Bitte wählen",-1)),(i(!0),s(g,null,y(V.value,t=>(i(),s("option",{key:t.id,value:t.name},d(t.nameDe||t.name),9,B))),128))],512),[[N,r.value.gender]])]),l("div",null,[e[11]||(e[11]=l("label",{for:"centerSelect"},"Zentrum:",-1)),o(l("select",{"onUpdate:modelValue":e[6]||(e[6]=t=>r.value.center=t),id:"centerSelect"},[e[10]||(e[10]=l("option",{value:""},"Bitte wählen",-1)),(i(!0),s(g,null,y(h.value,t=>(i(),s("option",{key:t.id,value:t.name},d(t.nameDe||t.name),9,R))),128))],512),[[N,r.value.center]])]),l("div",null,[l("label",null,[o(l("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=t=>r.value.isRealPerson=t)},null,512),[[U,r.value.isRealPerson]]),e[12]||(e[12]=D(" Reale Person (abgehakt = ja, nicht abgehakt = Testdaten) ",-1))])]),e[19]||(e[19]=l("hr",null,null,-1)),l("button",{type:"submit",disabled:p(a).loading,class:"btn btn-primary"},d(p(a).loading?"Wird gespeichert...":"Patient erstellen"),9,T),l("button",{type:"button",class:"btn btn-secondary ms-2",onClick:S}," Abbrechen "),p(a).error?(i(),s("div",A,d(p(a).error),1)):c("",!0),m.value?(i(),s("div",G,d(m.value),1)):c("",!0)],32)]))}}),L=C(Y,[["__scopeId","data-v-46f3434e"]]);export{L as P};
