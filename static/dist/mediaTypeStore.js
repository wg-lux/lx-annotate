import{O as F,h as y,e as d}from"./main.js";function f(s,i){return`${s}:${i}`}const j=F("mediaType",()=>{const s=y(null),i=y(new Map),m=y(new Map);function T(e){for(const n of e){const t=(n.mediaType??"").toLowerCase(),o=t==="pdf"?"pdf":t==="video"?"video":"unknown";o!=="unknown"&&v(n.id,o,o)}}function v(e,n,t){const o=t??n??"unknown";if(o==="unknown")return;const r=f(o,e),P=i.value.get(r),l=n==="unknown"?P??"unknown":n;if(l!=="unknown"){i.value.set(r,l);try{sessionStorage.setItem(`mediaType:${r}`,l)}catch{}}}function a(e,n){if(n){const t=f(n,e),o=i.value.get(t);if(o)return o;try{const r=sessionStorage.getItem(`mediaType:${t}`);if(r)return i.value.set(t,r),r}catch{}return"unknown"}for(const t of["video","pdf","meta"]){const o=f(t,e),r=i.value.get(o);if(r&&r!=="unknown")return r}return"unknown"}function C(e,n){const t=a(n,e);k({id:n,scope:e,mediaType:t}),console.log(`MediaTypeStore: setCurrentByKey(${e}, ${n}) â†’ type=${t}`),console.log("CurrentItem:",s.value)}function g(e){const n=new Set;for(const t of["video","pdf","meta"]){const o=a(e,t);o&&o!=="unknown"&&n.add(o)}return[...n]}function b(e,n){const t=g(e);if(t.length===1)return t[0];if(t.length>1){if(n==="prefer-video"&&t.includes("video"))return"video";if(n==="prefer-pdf"&&t.includes("pdf"))return"pdf"}return"unknown"}function x(e,n){const t=f(e,n.id);m.value.set(t,{...n,scope:e})}function p(e,n){const t=f(e,n);return m.value.get(t)}function S(e,n){return p(e,n)?.rawStreamUrl}function I(e,n){return p(e,n)?.processedStreamUrl}const u={pdf:{icon:"fas fa-file-pdf text-danger",badgeClass:"bg-danger",displayName:"PDF",supportedExtensions:[".pdf"]},video:{icon:"fas fa-video text-primary",badgeClass:"bg-primary",displayName:"Video",supportedExtensions:[".mp4",".avi",".mov",".mkv",".webm"]},unknown:{icon:"fas fa-question-circle text-muted",badgeClass:"bg-secondary",displayName:"Unbekannt",supportedExtensions:[]}},c=d(()=>{const e=s.value;return e?w(e):"unknown"}),M=d(()=>c.value==="pdf"),$=d(()=>c.value==="video"),E=d(()=>c.value==="unknown"),U=d(()=>u[c.value]);function w(e){if(e.scope&&e.scope!=="unknown"){const t=a(e.id,e.scope);if(t!=="unknown")return t}if(e.mediaType&&e.mediaType!=="unknown")return e.mediaType;const n=a(e.id);if(n!=="unknown")return n;if(e.filename){const t=`.${e.filename.toLowerCase().split(".").pop()||""}`;if(u.video.supportedExtensions.includes(t))return"video";if(u.pdf.supportedExtensions.includes(t))return"pdf"}return"unknown"}function k(e){s.value=e}function B(e){s.value&&(s.value={...s.value,...e})}function K(){s.value=null}function h(e){return u[e]}function L(e){const n=`.${e.toLowerCase().split(".").pop()||""}`;return Object.values(u).some(t=>t.supportedExtensions.includes(n))}function N(e){return u[e]?.icon||u.unknown.icon}function O(e){return u[e]?.badgeClass||u.unknown.badgeClass}return{currentItem:s,currentMediaType:c,isPdf:M,isVideo:$,isUnknown:E,currentMediaConfig:U,seedTypesFromOverview:T,rememberType:v,getType:a,setCurrentByKey:C,getAllTypes:g,resolveType:b,setItem:x,getItem:p,getRawStreamUrl:S,getProcessedStreamUrl:I,detectMediaType:w,setCurrentItem:k,updateCurrentItem:B,clearCurrentItem:K,getMediaTypeConfig:h,isSupportedExtension:L,getMediaTypeIcon:N,getMediaTypeBadgeClass:O}});export{j as u};
