import{L as at,h as f,e as b,d as ke,i as De,w as xe,c as u,j as x,a as e,x as nt,q as Ve,n as X,t as r,k as c,F as ge,m as $e,o,z as ne,_ as Fe,f as st,g as it,J as lt,p as J,b as Se,C as rt,r as ot,l as W,H as ut,G as ae,v as dt,A as le,y as ct}from"./main.js";import{u as Me}from"./videoStore.js";import{u as vt}from"./patientStore.js";import{u as mt}from"./mediaTypeStore.js";import{T as ft}from"./Timeline.js";import{u as gt}from"./usePollingProtection.js";const pt=at("pdf",()=>{const w=f(null),i=f(!1),n=f(null),m=f(!1),l=f(null),P=b(()=>w.value!==null),$=b(()=>w.value?.status==="processing"),_=b(()=>w.value?.status==="done"),k=b(()=>n.value!==null||w.value?.error===!0),V=b(()=>w.value?.pdfStreamUrl?w.value.pdfStreamUrl:null);function E(g){return`/api/media/pdfs/${g}/stream`}async function v(g){i.value=!0,n.value=null;try{const d=await fetch("/api/anonymization/items/overview/");if(!d.ok)throw new Error(`Failed to fetch overview: ${d.status}`);const I=(await d.json()).pdfs?.filter(j=>j.status==="pending_validation"||j.status==="not_started")||[];if(I.length===0){w.value=null,l.value=null;return}let U;if(g){const j=I.findIndex(q=>q.id===g);U=I[j+1]||I[0]}else U=I[0];w.value=U,l.value=U.id,U.id&&w.value&&(w.value.pdfStreamUrl=E(U.id),m.value=!0)}catch(d){n.value=d instanceof Error?d.message:"Unknown error occurred",console.error("Error fetching next PDF:",d)}finally{i.value=!1}}async function G(g,d){if(!w.value)throw new Error("No current PDF to update");i.value=!0,n.value=null;try{const D=await fetch(`/api/media/pdfs/${g}/sensitive-metadata/`,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRFToken":S()},body:JSON.stringify(d)});if(!D.ok)throw new Error(`Failed to update sensitive metadata: ${D.status}`);const I=await D.json();w.value.reportMeta&&(w.value.reportMeta={...w.value.reportMeta,...I})}catch(D){throw n.value=D instanceof Error?D.message:"Unknown error occurred",console.error("Error updating sensitive metadata:",D),D}finally{i.value=!1}}async function L(g,d){if(!w.value)throw new Error("No current PDF to update");i.value=!0,n.value=null;try{const D=await fetch(`/api/media/pdfs/${g}/sensitive-metadata/`,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRFToken":S()},body:JSON.stringify({anonymized_text:d})});if(!D.ok)throw new Error(`Failed to update anonymized text: ${D.status}`);w.value.anonymizedText=d,w.value.status="done"}catch(D){throw n.value=D instanceof Error?D.message:"Unknown error occurred",console.error("Error updating anonymized text:",D),D}finally{i.value=!1}}async function F(){if(!w.value)throw new Error("No current PDF to approve");const g=w.value.id;i.value=!0,n.value=null;try{const d=await fetch(`/api/anonymization/${g}/validate/`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":S()},body:JSON.stringify({validation_status:"approved"})});if(!d.ok)throw new Error(`Failed to approve PDF: ${d.status}`);l.value=g,await v(g)}catch(d){throw n.value=d instanceof Error?d.message:"Unknown error occurred",console.error("Error approving PDF:",d),d}finally{i.value=!1}}async function C(){if(!w.value)throw new Error("No current PDF to skip");const g=w.value.id;l.value=g,await v(g)}async function N(g){try{const d=await fetch(`/api/anonymization/${g}/status/`);if(!d.ok)throw new Error(`Failed to check status: ${d.status}`);return await d.json()}catch(d){throw n.value=d instanceof Error?d.message:"Unknown error occurred",console.error("Error checking anonymization status:",d),d}}function B(){m.value=!1}function O(){w.value=null,i.value=!1,n.value=null,m.value=!1,l.value=null}function S(){const g=document.querySelector("[name=csrfmiddlewaretoken]")?.getAttribute("value");if(!g)throw new Error("CSRF token not found");return g}return{currentPdf:w,loading:i,error:n,streamingActive:m,lastProcessedId:l,hasCurrentPdf:P,isProcessing:$,isDone:_,hasError:k,pdfStreamUrl:V,buildPdfStreamUrl:E,fetchNextPdf:v,updateSensitiveMeta:G,updateAnonymizedText:L,approvePdf:F,skipPdf:C,checkAnonymizationStatus:N,stopStreaming:B,clearState:O}}),bt={class:"video-with-outside-timeline"},ht={key:0,class:"validation-status mb-3"},yt={class:"row align-items-center"},wt={class:"col-md-8"},_t={class:"progress"},St={class:"col-md-4 text-end"},kt=["disabled"],Dt={key:0,class:"spinner-border spinner-border-sm me-1"},xt={key:1,class:"fas fa-check-double me-1"},Vt=["disabled"],$t=["src"],Ft={key:1,class:"segments-overview mb-3"},Mt={class:"segments-list"},At={class:"ms-2 text-muted"},Pt={class:"ms-2 badge bg-secondary"},Et=["onClick","disabled"],zt={key:1,class:"text-success"},It={key:2,class:"alert alert-info"},Yt=ke({__name:"OutsideSegmentComponent",props:{videoId:{}},emits:["segment-validated","validation-complete"],setup(w,{emit:i}){const n=w,m=i,l=f(null),P=f(""),$=f(0),_=f(0),k=f(!1),V=Me(),E=f(new Set),v=f(!1);async function G(y){const{data:p}=await ne.get(`/api/media/videos/${y}/`);P.value=p.video_url,$.value=Number(p.duration??0)}async function L(y){await V.fetchAllSegments(y)}const F=b(()=>(V.allSegments??[]).filter(p=>(p.label??"").toLowerCase()==="outside").map(p=>({...p}))),C=b(()=>F.value.filter(y=>!E.value.has(y.id))),N=b(()=>F.value.length>0&&C.value.length===0);async function B(y){if(!(E.value.has(y.id)||v.value)){v.value=!0;try{E.value.add(y.id),m("segment-validated",y.id),console.log(`‚úÖ Segment ${y.id} validated`),N.value&&(m("validation-complete"),console.log("üéâ All outside segments validated!"))}catch(p){console.error("Error validating segment:",p),E.value.delete(y.id)}finally{v.value=!1}}}async function O(){for(const y of C.value)await B(y)}function S(){E.value.clear()}function g(y){const p=Math.floor(y/60),M=Math.floor(y%60);return`${p.toString().padStart(2,"0")}:${M.toString().padStart(2,"0")}`}De(()=>{l.value&&(l.value.addEventListener("loadedmetadata",()=>{!$.value&&l.value&&($.value=l.value.duration||0)}),l.value.addEventListener("timeupdate",()=>{l.value&&(_.value=l.value.currentTime)}),l.value.addEventListener("play",()=>{k.value=!0}),l.value.addEventListener("pause",()=>{k.value=!1}))}),xe(()=>n.videoId,async y=>{S(),await Promise.all([G(y),L(y)])},{immediate:!0});function d(...y){const[p]=y;l.value&&Number.isFinite(p)&&(l.value.currentTime=p),_.value=p}function D(){l.value&&(l.value.paused?l.value.play().catch(()=>{}):l.value.pause(),k.value=!l.value.paused)}function I(){}function U(){}function j(){}function q(){}function de(){}function ce(){}function Z(){}return(y,p)=>(o(),u("div",bt,[F.value.length>0?(o(),u("div",ht,[e("div",yt,[e("div",wt,[e("div",_t,[e("div",{class:X(["progress-bar",N.value?"bg-success":"bg-warning"]),style:Ve(`width: ${E.value.size/F.value.length*100}%`)},r(E.value.size)+" / "+r(F.value.length)+" validiert ",7)])]),e("div",St,[e("button",{class:"btn btn-sm btn-success me-2",onClick:O,disabled:v.value||N.value},[v.value?(o(),u("span",Dt)):(o(),u("i",xt)),p[0]||(p[0]=c(" Alle validieren ",-1))],8,kt),e("button",{class:"btn btn-sm btn-outline-secondary",onClick:S,disabled:v.value||E.value.size===0},[...p[1]||(p[1]=[e("i",{class:"fas fa-redo me-1"},null,-1),c(" Zur√ºcksetzen ",-1)])],8,Vt)])])])):x("",!0),e("video",{ref_key:"videoEl",ref:l,src:P.value,controls:"",style:{width:"100%","max-height":"480px"}},null,8,$t),F.value.length>0?(o(),u("div",Ft,[e("h6",null,"Outside-Segmente ("+r(F.value.length)+")",1),e("div",Mt,[(o(!0),u(ge,null,$e(F.value,M=>(o(),u("div",{key:M.id,class:X(["segment-item d-flex justify-content-between align-items-center mb-2 p-2 border rounded",{"border-success bg-success bg-opacity-10":E.value.has(M.id),"border-warning bg-warning bg-opacity-10":!E.value.has(M.id)}])},[e("div",null,[e("strong",null,"Segment "+r(M.id),1),e("span",At,r(g(M.startTime))+" - "+r(g(M.endTime)),1),e("span",Pt,r(M.label),1)]),e("div",null,[E.value.has(M.id)?(o(),u("span",zt,[...p[3]||(p[3]=[e("i",{class:"fas fa-check-circle me-1"},null,-1),c(" Validiert ",-1)])])):(o(),u("button",{key:0,class:"btn btn-sm btn-outline-success",onClick:pe=>B(M),disabled:v.value},[...p[2]||(p[2]=[e("i",{class:"fas fa-check me-1"},null,-1),c(" Validieren ",-1)])],8,Et))])],2))),128))])])):(o(),u("div",It,[p[4]||(p[4]=e("i",{class:"fas fa-info-circle me-2"},null,-1)),c(' Keine "Outside"-Segmente f√ºr Video '+r(n.videoId)+" gefunden. ",1)])),F.value.length>0?(o(),nt(ft,{key:3,video:{duration:$.value},segments:F.value,"current-time":_.value,"is-playing":k.value,"selection-mode":!1,onSeek:d,onPlayPause:D,onSegmentCreate:I,onSegmentResize:U,onSegmentMove:j,onTimeSelection:q,onSegmentSelect:de,onSegmentEdit:ce,onSegmentDelete:Z},null,8,["video","segments","current-time","is-playing"])):x("",!0)]))}}),Nt=Fe(Yt,[["__scopeId","data-v-f646399d"]]);class z{static toISO(i){if(!i)return null;const n=i.trim().split(" ")[0],l=/^(\d{4})-(\d{2})-(\d{2})$/.exec(n);if(l){const[,_,k,V]=l;return this._isValidDate(parseInt(_),parseInt(k),parseInt(V))?n:null}const $=/^(\d{2})\.(\d{2})\.(\d{4})$/.exec(n);if($){const[,_,k,V]=$;return this._isValidDate(parseInt(V),parseInt(k),parseInt(_))?`${V}-${k}-${_}`:null}return null}static toGerman(i){if(!i)return"";const n=i.trim(),l=/^(\d{4})-(\d{2})-(\d{2})$/.exec(n);if(!l)return"";const[,P,$,_]=l;return this._isValidDate(parseInt(P),parseInt($),parseInt(_))?`${_}.${$}.${P}`:""}static validate(i,n){if(!i)return!1;const m=i.trim();if(n==="ISO"){const P=/^(\d{4})-(\d{2})-(\d{2})$/.exec(m);if(!P)return!1;const[,$,_,k]=P;return this._isValidDate(parseInt($),parseInt(_),parseInt(k))}if(n==="German"){const P=/^(\d{2})\.(\d{2})\.(\d{4})$/.exec(m);if(!P)return!1;const[,$,_,k]=P;return this._isValidDate(parseInt(k),parseInt(_),parseInt($))}return!1}static compare(i,n){if(!this.validate(i,"ISO")||!this.validate(n,"ISO"))return null;const m=new Date(i),l=new Date(n);return m<l?-1:m>l?1:0}static isBefore(i,n){return this.compare(i,n)===-1}static isAfter(i,n){return this.compare(i,n)===1}static isBeforeOrEqual(i,n){const m=this.compare(i,n);return m===-1||m===0}static isAfterOrEqual(i,n){const m=this.compare(i,n);return m===1||m===0}static today(){const i=new Date,n=i.getFullYear(),m=String(i.getMonth()+1).padStart(2,"0"),l=String(i.getDate()).padStart(2,"0");return`${n}-${m}-${l}`}static todayGerman(){return this.toGerman(this.today())}static _isValidDate(i,n,m){if(i<1900||i>2100||n<1||n>12||m<1||m>31)return!1;const l=new Date(i,n-1,m);return l.getFullYear()===i&&l.getMonth()===n-1&&l.getDate()===m}}class Ot{errors=new Map;addField(i,n,m){if(!n){this.errors.set(i,`${i}: Pflichtfeld (darf nicht leer sein)`);return}if(!z.validate(n,m)){const l=m==="ISO"?"YYYY-MM-DD":"DD.MM.YYYY";this.errors.set(i,`${i}: Ung√ºltiges Format (erwartet: ${l})`)}}addConstraint(i,n,m){n||this.errors.set(i,m)}hasErrors(){return this.errors.size>0}getErrors(){return Array.from(this.errors.values())}getSummary(){const i=this.errors.size;return i===0?"Alle Datumsfelder sind g√ºltig":i===1?"1 Datumsfehler gefunden":`${i} Datumsfehler gefunden`}clear(){this.errors.clear()}getErrorsAsHtml(){return this.errors.size===0?"":`<ul class="date-validation-errors">${this.getErrors().map(n=>`<li>${n}</li>`).join("")}</ul>`}}const Ut={class:"container-fluid py-4"},Tt={class:"card"},Ct={class:"card-body"},Gt={key:0,class:"text-center py-5"},Bt={key:1,class:"alert alert-danger",role:"alert"},Lt={key:3,class:"alert alert-warning mt-3"},Rt={class:"mt-2"},Kt={class:"row mb-3"},jt={class:"col-12"},qt={class:"alert alert-info d-flex align-items-center justify-content-between",role:"alert"},Ht={key:0,class:"text-end"},Jt={class:"text-muted"},Wt={class:"row mb-4"},Xt={class:"col-12"},Zt={class:"form-check"},Qt={key:0,class:"row mb-4"},ea={class:"col-12"},ta={class:"alert alert-danger alert-dismissible fade show",role:"alert"},aa={class:"alert-heading"},na={class:"mb-0"},sa={class:"row mb-4"},ia={class:"col-md-5"},la={class:"card bg-light mb-4"},ra={class:"card-body"},oa={class:"mb-3"},ua={key:0,class:"invalid-feedback"},da={class:"mb-3"},ca={key:0,class:"invalid-feedback"},va={class:"mb-3"},ma={class:"mb-3"},fa={class:"form-text text-muted"},ga={key:0,class:"ms-2 badge bg-secondary"},pa={key:0,class:"invalid-feedback"},ba={class:"mb-3"},ha={class:"mb-3"},ya={class:"form-text text-muted"},wa={key:0,class:"ms-2 badge bg-secondary"},_a={key:0,class:"invalid-feedback"},Sa={class:"mb-3"},ka={class:"card bg-light"},Da={class:"card-body"},xa={key:0,class:"mt-3"},Va=["src"],$a={class:"mt-3"},Fa={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},Ma={class:"col-md-7"},Aa={class:"card"},Pa={class:"card-header pb-0"},Ea={class:"mb-0"},za={class:"alert alert-info mt-2 mb-0"},Ia={key:0},Ya={key:1},Na={key:2},Oa={class:"card-body media-viewer-container"},Ua={key:0,class:"dual-pdf-container"},Ta={class:"row"},Ca={class:"col-md-6"},Ga={class:"pdf-section raw-pdf"},Ba=["src"],La=["href"],Ra={class:"mt-2 text-center"},Ka={class:"text-muted"},ja={class:"col-md-6"},qa={class:"pdf-section anonymized-pdf"},Ha=["src"],Ja=["href"],Wa={class:"mt-2 text-center"},Xa={class:"text-muted"},Za={key:1,class:"dual-video-container"},Qa={class:"row"},en={class:"col-md-6"},tn={class:"video-section raw-video"},an=["src"],nn={class:"mt-2 text-center"},sn={class:"text-muted"},ln={class:"col-md-6"},rn={class:"video-section anonymized-video"},on=["src"],un={class:"mt-2 text-center"},dn={class:"text-muted"},cn={class:"video-controls mt-3 text-center"},vn=["disabled"],mn={key:0,class:"spinner-border spinner-border-sm me-1",role:"status"},fn={key:1,class:"fas fa-check me-1"},gn={key:0,class:"outside-timeline-container mt-4"},pn={class:"card border-warning"},bn={class:"card-header bg-warning bg-opacity-10"},hn={class:"d-flex justify-content-between align-items-center"},yn={class:"mb-0 text-warning"},wn={class:"text-end"},_n={class:"badge bg-warning text-dark fs-6"},Sn={class:"progress mt-2",style:{width:"200px",height:"8px"}},kn=["aria-valuenow","aria-valuemax"],Dn={class:"text-muted"},xn={class:"card-body"},Vn={key:0,class:"mt-2"},$n={key:2,class:"alert alert-warning"},Fn={class:"mb-0"},Mn={class:"row"},An={class:"col-12 d-flex justify-content-between"},Pn={class:"d-flex gap-2"},En=["disabled","title"],zn={key:0,class:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger",style:{"font-size":"0.6em"},title:"Ungespeicherte √Ñnderungen"},In=["disabled","title"],Yn={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},Nn={key:1,class:"alert alert-warning mt-2 mb-0"},On=ke({__name:"AnonymizationValidationComponent",setup(w){const i=gt(),n=st(),m=ct(),l=it(),P=Me();vt();const $=pt(),_=mt(),k=f(""),V=f(""),E=f(!1),v=f({patientFirstName:"",patientLastName:"",patientGender:"",patientDob:"",casenumber:""}),G=f([]),L=f(""),F=f(""),C=f(""),N=f(""),B=f(!1),O=f(!1),S=f(null),g=f(0),d=f(0),D=f(""),I=f(""),U=f(!1),j=f(!1),q=f({anonymizedText:"",examinationDate:"",patient:{patientFirstName:"",patientLastName:"",patientGender:"",patientDob:"",casenumber:""}});function de(a,t){return a.patientFirstName===t.patientFirstName&&a.patientLastName===t.patientLastName&&a.patientGender===t.patientGender&&a.patientDob===t.patientDob&&a.casenumber===t.casenumber}function ce(a){return{patient_first_name:v.value.patientFirstName||"",patient_last_name:v.value.patientLastName||"",patient_gender:v.value.patientGender||"",patient_dob:a,casenumber:v.value.casenumber||""}}const Z=b(()=>v.value.patientFirstName.trim().length>0),y=b(()=>v.value.patientLastName.trim().length>0),p=b(()=>z.toISO(v.value.patientDob)),M=b(()=>z.toISO(V.value)),pe=b(()=>{const a=G.value.length;return a===0?"Alle Felder sind g√ºltig":a===1?"1 Validierungsfehler gefunden":`${a} Validierungsfehler gefunden`}),se=b(()=>!!p.value),ie=b(()=>M.value?p.value?z.isAfterOrEqual(M.value,p.value):!1:!0),re=b(()=>Z.value&&y.value&&se.value&&ie.value),Ae=b(()=>re.value),ve=b(()=>!(!re.value||A.value&&O.value)),oe=b(()=>{if(!re.value){const a=[];return Z.value||a.push("Vorname"),y.value||a.push("Nachname"),se.value||a.push("g√ºltiges Geburtsdatum"),ie.value||a.push("g√ºltiges Untersuchungsdatum"),`Bitte korrigieren Sie: ${a.join(", ")}`}return A.value&&O.value?`Bitte validieren Sie zuerst alle Outside-Segmente (${d.value-g.value} verbleibend)`:""}),be=b(()=>d.value===0?0:Math.round(g.value/d.value*100)),s=b(()=>l.current),T=b(()=>s.value?_.detectMediaType(s.value)==="pdf":!1),A=b(()=>s.value?_.detectMediaType(s.value)==="video":!1);b(()=>{if(!(!T.value||!s.value))return _.getPdfUrl(s.value)||$.pdfStreamUrl||$.buildPdfStreamUrl(s.value.id)}),b(()=>{if(!(!A.value||!s.value))return _.getVideoUrl(s.value)});const me=b(()=>!A.value||!s.value?void 0:`${window.location.origin}/api/media/videos/${s.value.id}/?type=raw`),fe=b(()=>!A.value||!s.value?void 0:`${window.location.origin}/api/media/videos/${s.value.id}/?type=processed`),Q=b(()=>!T.value||!s.value?void 0:`${window.location.origin}/api/media/pdfs/${s.value.id}/stream/?type=raw`),ee=b(()=>!T.value||!s.value?void 0:`${window.location.origin}/api/media/pdfs/${s.value.id}/stream/?type=processed`),R=f(null),K=f(null),Pe=a=>{console.error("Raw video error:",a)},Ee=()=>{console.log("Raw video load started")},ze=()=>{console.log("Raw video can play")},Ie=a=>{console.error("Anonymized video error:",a)},Ye=()=>{console.log("Anonymized video load started")},Ne=()=>{console.log("Anonymized video can play")},he=(a,t)=>{if(!R.value||!K.value)return;const Y=a==="raw"?R.value:K.value,h=a==="raw"?K.value:R.value;Math.abs(Y.currentTime-h.currentTime)>.5&&(h.currentTime=Y.currentTime)},Oe=()=>{if(!R.value||!K.value)return;const a=(R.value.currentTime+K.value.currentTime)/2;R.value.currentTime=a,K.value.currentTime=a,console.log("Videos synchronized to time:",a)},Ue=()=>{R.value&&R.value.pause(),K.value&&K.value.pause(),console.log("All videos paused")},Te=()=>{if(!Q.value){n.warning({text:"Original-PDF nicht verf√ºgbar."});return}window.open(Q.value,"_blank"),console.log("Downloading raw PDF:",Q.value)},Ce=()=>{if(!ee.value){n.warning({text:"Anonymisiertes PDF nicht verf√ºgbar."});return}window.open(ee.value,"_blank"),console.log("Downloading anonymized PDF:",ee.value)},Ge=async()=>{if(!s.value||!A.value){n.warning({text:"Kein Video zur Validierung ausgew√§hlt."});return}B.value=!0,O.value=!1,S.value=null;try{console.log(`üîç Validating video ${s.value.id} for segment annotation...`);const t=(await ne.get(le(`media/videos/${s.value.id}/validation/segments/`))).data;if(console.log("Video validation response:",t),t.eligible){const h=(await ne.get(le(`media/videos/${s.value.id}/segments/?label=outside`))).data;d.value=h.length,g.value=0,h.length>0?(O.value=!0,S.value={class:"alert-warning",icon:"fas fa-exclamation-triangle",title:"Segmentvalidierung erforderlich",message:`${h.length} "Outside"-Segmente gefunden, die validiert werden m√ºssen.`,details:"Verwenden Sie die Timeline unten, um die Segmente zu √ºberpr√ºfen und zu best√§tigen."}):S.value={class:"alert-success",icon:"fas fa-check-circle",title:"Video bereit f√ºr Annotation",message:'Keine "Outside"-Segmente gefunden. Video ist bereit f√ºr die Segment-Annotation.',details:`Video ID: ${s.value.id} - Alle Validierungen bestanden.`}}else S.value={class:"alert-danger",icon:"fas fa-times-circle",title:"Video nicht bereit",message:t.reasons?.join(", ")||"Video ist nicht f√ºr Segment-Annotation geeignet.",details:"√úberpr√ºfen Sie die Video-Verarbeitung und Metadaten-Extraktion."};n.info({text:`Video ${s.value.id} validiert`})}catch(a){console.error("Error validating video for segment annotation:",a);try{await P.fetchAllSegments(s.value.id);const t=P.allSegments.filter(Y=>Y.label==="outside");d.value=t.length,g.value=0,t.length>0?(O.value=!0,S.value={class:"alert-warning",icon:"fas fa-exclamation-triangle",title:"Outside-Segmente gefunden (Fallback)",message:`${t.length} "Outside"-Segmente zur Validierung gefunden.`,details:"Fallback-Validierung √ºber VideoStore. API-Endpoint nicht verf√ºgbar."}):S.value={class:"alert-info",icon:"fas fa-info-circle",title:"Fallback-Validierung",message:'Keine "Outside"-Segmente gefunden (√ºber VideoStore).',details:"API-Validierung fehlgeschlagen, Fallback verwendet."}}catch{S.value={class:"alert-danger",icon:"fas fa-times-circle",title:"Validierung fehlgeschlagen",message:"Video konnte nicht f√ºr Segment-Annotation validiert werden.",details:a?.response?.data?.detail||a?.message||"Unbekannter Fehler"}}}finally{B.value=!1}},Be=a=>{g.value++,console.log(`‚úÖ Segment ${a} validated. Progress: ${g.value}/${d.value}`),S.value&&(S.value.message=`Fortschritt: ${g.value}/${d.value} Outside-Segmente validiert.`)},Le=()=>{console.log("üéâ All outside segments validated!"),O.value=!1,S.value={class:"alert-success",icon:"fas fa-check-circle",title:"Validierung abgeschlossen",message:"Alle Outside-Segmente wurden erfolgreich validiert.",details:`Video ${s.value?.id} ist jetzt bereit f√ºr die vollst√§ndige Segment-Annotation.`},n.success({text:"Outside-Segment Validierung abgeschlossen!"})},ye=a=>{if(!a)return;O.value=!1,S.value=null,g.value=0,d.value=0,B.value=!1,k.value=a.anonymizedText||"";const t=a.reportMeta?.examinationDate||"",Y=a.reportMeta?.patientDob||"";V.value=z.toISO(t)||"";const h={patientFirstName:a.reportMeta?.patientFirstName||"",patientLastName:a.reportMeta?.patientLastName||"",patientGender:a.reportMeta?.patientGender||"",patientDob:z.toISO(Y)||"",casenumber:a.reportMeta?.casenumber||""};v.value={...h},q.value={anonymizedText:k.value,examinationDate:V.value,patient:{...h}}};xe(s,a=>{a&&(_.setCurrentItem(a),ye(a))},{immediate:!0});const ue=async()=>{try{await l.fetchNext()}catch(a){console.error("Error fetching next item:",a)}},Re=b(()=>k.value!==q.value.anonymizedText||V.value!==q.value.examinationDate||!de(v.value,q.value.patient)),Ke=b(()=>s.value&&!te.value&&!H.value),te=f(!1),H=f(!1),je=()=>{U.value=!U.value};function we(){const a=new Ot;if(G.value=[],L.value="",F.value="",v.value.patientDob){const t=v.value.patientDob;z.validate(t,"ISO")?C.value="ISO (YYYY-MM-DD)":z.validate(t,"German")?C.value="Deutsch (DD.MM.YYYY)":(C.value="",L.value="Ung√ºltiges Format. Verwenden Sie DD.MM.YYYY oder YYYY-MM-DD",a.addField("Geburtsdatum",t,"German"))}else C.value="";if(V.value){const t=V.value;z.validate(t,"ISO")?N.value="ISO (YYYY-MM-DD)":z.validate(t,"German")?N.value="Deutsch (DD.MM.YYYY)":(N.value="",F.value="Ung√ºltiges Format. Verwenden Sie DD.MM.YYYY oder YYYY-MM-DD",a.addField("Untersuchungsdatum",t,"ISO"))}else N.value="";p.value&&M.value&&a.addConstraint("DOB_BEFORE_EXAM",z.isBeforeOrEqual(p.value,M.value),"Geburtsdatum muss vor oder am selben Tag wie das Untersuchungsdatum liegen"),a.hasErrors()&&(G.value=a.getErrors(),a.getErrors().forEach(Y=>{Y.includes("Geburtsdatum")&&(L.value=Y.replace("Geburtsdatum: ","")),Y.includes("Untersuchungsdatum")&&(F.value=Y.replace("Untersuchungsdatum: ",""))}))}function qe(){const a=v.value.patientDob;if(!a)return;const t=z.toISO(a);t&&(v.value.patientDob=t,C.value="ISO (YYYY-MM-DD)"),we()}function He(){const a=V.value;if(!a)return;const t=z.toISO(a);t&&(V.value=t,N.value="ISO (YYYY-MM-DD)"),we()}function Je(){G.value=[],L.value="",F.value=""}const We=async()=>{s.value&&await ue()},Xe=()=>{if(!s.value){n.error({text:"Kein Video zur Segmentierung ausgew√§hlt."});return}m.push({name:"Video-Untersuchung",query:{video:s.value.id.toString()}}),console.log(`üéØ Navigating to Video-Untersuchung with video ID: ${s.value.id}`)},Ze=async()=>{if(!(!s.value||!Ke.value||H.value)){if(!ve.value){const a=oe.value;console.warn(`‚ùå Approval blocked: ${a}`),n.warning({text:a});return}if(A.value&&O.value){console.warn("‚ùå Outside segments still pending validation"),n.error({text:"Bitte validieren Sie zuerst alle Outside-Segmente, bevor Sie das Video best√§tigen."});return}H.value=!0;try{console.log(`Validating anonymization for file ${s.value.id}...`);try{await ne.post(le(`anonymization/${s.value.id}/validate/`),{patient_first_name:v.value.patientFirstName,patient_last_name:v.value.patientLastName,patient_gender:v.value.patientGender,patient_dob:z.toGerman(p.value||"")||"",examination_date:z.toGerman(M.value||"")||"",casenumber:v.value.casenumber||"",anonymized_text:T.value?k.value:void 0,is_verified:!0,file_type:T.value?"pdf":A.value?"video":"unknown"}),console.log(`Anonymization validated successfully for file ${s.value.id}`),n.success({text:"Dokument best√§tigt und Anonymisierung validiert"})}catch(a){console.error("Error validating anonymization:",a),n.warning({text:"Dokument best√§tigt, aber Validierung fehlgeschlagen"})}i.validateAnonymizationSafeWithProtection(s.value.id,"pdf"),await Xe()}catch(a){console.error("Error approving item:",a),n.error({text:"Fehler beim Best√§tigen des Elements"})}finally{H.value=!1}}},Qe=async()=>{if(!te.value){if(!Ae.value){if(!I.value||!D.value)n.error({text:"Bitte laden Sie zuerst Bilder hoch (Original und bearbeitetes Bild)."});else if(!re.value){const a=[];Z.value||a.push("Vorname"),y.value||a.push("Nachname"),se.value||a.push("g√ºltiges Geburtsdatum"),ie.value||a.push("g√ºltiges Untersuchungsdatum (darf nicht vor Geburtsdatum liegen)"),n.error({text:`Bitte korrigieren Sie: ${a.join(", ")}`})}return}te.value=!0;try{const a={processed_image_url:I.value,patient_data:ce(z.toGerman(p.value||"")||""),examinationDate:z.toGerman(M.value||"")||"",anonymized_text:k.value};if(s.value&&A.value)await ne.post(le("save-anonymization-annotation-video/"),{...a,itemId:s.value.id});else if(s.value&&T.value)await ne.post(le("save-anonymization-annotation-pdf/"),a);else{n.error({text:"Keine g√ºltige Anonymisierung zum Speichern gefunden."});return}D.value="",I.value="",j.value=!1,n.success({text:"Annotation erfolgreich gespeichert"})}catch(a){console.error("Error saving annotation:",a),n.error({text:"Fehler beim Speichern der Annotation"})}finally{te.value=!1}}},et=async()=>{s.value&&await ue()},tt=async()=>{if(!s.value){n.error({text:"Kein Element zur Korrektur ausgew√§hlt."});return}try{m.push({name:"Anonymisierung Korrektur",params:{fileId:s.value.id.toString()}}),n.info({text:"√Ñnderungen gespeichert. Bitte w√§hlen Sie das Element erneut f√ºr die Korrektur aus."});return}catch{n.error({text:"Fehler beim Speichern. Korrektur-Navigation abgebrochen."});return}};return De(async()=>{l.current?ye(l.current):await ue()}),lt(()=>{ue()}),(a,t)=>{const Y=ot("router-link");return o(),u("div",Ut,[e("div",Tt,[t[66]||(t[66]=e("div",{class:"card-header pb-0"},[e("h4",{class:"mb-0"},"Anonymisierungsvalidierung und Annotationen")],-1)),e("div",Ct,[J(l).loading?(o(),u("div",Gt,[...t[11]||(t[11]=[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"Wird geladen...")],-1),e("p",{class:"mt-2"},"Anonymisierte Daten werden geladen...",-1)])])):J(l).error?(o(),u("div",Bt,[t[12]||(t[12]=e("strong",null,"Fehler:",-1)),c(" "+r(J(l).error),1)])):s.value?x("",!0):(o(),u("div",{key:2,class:"alert alert-info",role:"alert",onLoadstart:t[0]||(t[0]=h=>J(l).fetchNext())}," Alle Anonymisierungen wurden bearbeitet. ",32)),J(l).isAnyFileProcessing?(o(),u("div",Lt,[t[14]||(t[14]=e("i",{class:"fas fa-info-circle me-2"},null,-1)),e("strong",null,r(J(l).processingFiles.length)+" Datei(en)",1),t[15]||(t[15]=c(" werden gerade anonymisiert. ",-1)),e("div",Rt,[Se(Y,{to:"/anonymisierung/uebersicht",class:"btn btn-sm btn-outline-primary"},{default:rt(()=>[...t[13]||(t[13]=[e("i",{class:"fas fa-eye me-1"},null,-1),c(" Zur √úbersicht ",-1)])]),_:1})])])):x("",!0)]),s.value?(o(),u(ge,{key:0},[e("div",Kt,[e("div",jt,[e("div",qt,[e("div",null,[t[17]||(t[17]=e("i",{class:"fas fa-info-circle me-2"},null,-1)),e("span",null,[t[16]||(t[16]=e("strong",null,"Validierung:",-1)),c(" "+r(T.value?"PDF-Dokument":A.value?"Video-Datei":"Unbekanntes Format")+" "+r(s.value?.reportMeta?.centerName?`- ${s.value.reportMeta.centerName}`:""),1)])]),s.value&&(A.value||T.value)?(o(),u("div",Ht,[e("small",Jt,[t[18]||(t[18]=e("i",{class:"fas fa-tools me-1"},null,-1)),c(" "+r(A.value?"Video-Korrektur verf√ºgbar":"Text-Korrektur verf√ºgbar"),1)])])):x("",!0)])])]),e("div",Wt,[e("div",Xt,[e("div",Zt,[W(e("input",{type:"checkbox",class:"form-check-input",id:"noMoreNames","onUpdate:modelValue":t[1]||(t[1]=h=>E.value=h)},null,512),[[ut,E.value]]),t[19]||(t[19]=e("label",{class:"form-check-label",for:"noMoreNames"}," Keine weiteren Namen im Video oder PDF vorhanden ",-1))])])]),G.value.length>0?(o(),u("div",Qt,[e("div",ea,[e("div",ta,[e("h6",aa,[t[20]||(t[20]=e("i",{class:"fas fa-exclamation-triangle me-2"},null,-1)),c(" "+r(pe.value),1)]),t[21]||(t[21]=e("hr",null,null,-1)),e("ul",na,[(o(!0),u(ge,null,$e(G.value,(h,_e)=>(o(),u("li",{key:_e},r(h),1))),128))]),e("button",{type:"button",class:"btn-close",onClick:Je,"aria-label":"Schlie√üen"})])])])):x("",!0),e("div",sa,[e("div",ia,[e("div",la,[e("div",ra,[t[34]||(t[34]=e("h5",{class:"card-title"},"Patienteninformationen",-1)),e("div",oa,[t[22]||(t[22]=e("label",{class:"form-label"},"Vorname:",-1)),W(e("input",{type:"text",class:X(["form-control",{"is-invalid":!Z.value}]),"onUpdate:modelValue":t[2]||(t[2]=h=>v.value.patientFirstName=h)},null,2),[[ae,v.value.patientFirstName]]),Z.value?x("",!0):(o(),u("div",ua," Vorname ist erforderlich. "))]),e("div",da,[t[23]||(t[23]=e("label",{class:"form-label"},"Nachname:",-1)),W(e("input",{type:"text",class:X(["form-control",{"is-invalid":!y.value}]),"onUpdate:modelValue":t[3]||(t[3]=h=>v.value.patientLastName=h)},null,2),[[ae,v.value.patientLastName]]),y.value?x("",!0):(o(),u("div",ca," Nachname ist erforderlich. "))]),e("div",va,[t[25]||(t[25]=e("label",{class:"form-label"},"Geschlecht:",-1)),W(e("select",{class:"form-select","onUpdate:modelValue":t[4]||(t[4]=h=>v.value.patientGender=h)},[...t[24]||(t[24]=[e("option",{value:"male"},"M√§nnlich",-1),e("option",{value:"female"},"Weiblich",-1),e("option",{value:"other"},"Divers",-1)])],512),[[dt,v.value.patientGender]])]),e("div",ma,[t[28]||(t[28]=e("label",{class:"form-label"},"Geburtsdatum:",-1)),W(e("input",{type:"date",class:X(["form-control",{"is-invalid":!se.value}]),"onUpdate:modelValue":t[5]||(t[5]=h=>v.value.patientDob=h),onBlur:qe},null,34),[[ae,v.value.patientDob]]),e("small",fa,[t[26]||(t[26]=e("i",{class:"fas fa-info-circle me-1"},null,-1)),t[27]||(t[27]=c(" Format: DD.MM.YYYY oder YYYY-MM-DD ",-1)),C.value?(o(),u("span",ga,r(C.value),1)):x("",!0)]),se.value?x("",!0):(o(),u("div",pa,r(L.value||"G√ºltiges Geburtsdatum ist erforderlich."),1))]),e("div",ba,[t[29]||(t[29]=e("label",{class:"form-label"},"Fallnummer:",-1)),W(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[6]||(t[6]=h=>v.value.casenumber=h)},null,512),[[ae,v.value.casenumber]])]),e("div",ha,[t[32]||(t[32]=e("label",{class:"form-label"},"Untersuchungsdatum:",-1)),W(e("input",{type:"date",class:X(["form-control",{"is-invalid":!ie.value}]),"onUpdate:modelValue":t[7]||(t[7]=h=>V.value=h),onBlur:He},null,34),[[ae,V.value]]),e("small",ya,[t[30]||(t[30]=e("i",{class:"fas fa-info-circle me-1"},null,-1)),t[31]||(t[31]=c(" Format: DD.MM.YYYY oder YYYY-MM-DD ",-1)),N.value?(o(),u("span",wa,r(N.value),1)):x("",!0)]),ie.value?x("",!0):(o(),u("div",_a,r(F.value||"Das Untersuchungsdatum darf nicht vor dem Geburtsdatum liegen."),1))]),e("div",Sa,[t[33]||(t[33]=e("label",{class:"form-label"},"Anonymisierter Text:",-1)),W(e("textarea",{class:"form-control",rows:"6","onUpdate:modelValue":t[8]||(t[8]=h=>k.value=h)},null,512),[[ae,k.value]])])])]),e("div",ka,[e("div",Da,[t[35]||(t[35]=e("h5",{class:"card-title"},"Annotationen",-1)),I.value?(o(),u("div",xa,[e("img",{src:U.value?D.value:I.value,class:"img-fluid",alt:"Uploaded Image"},null,8,Va),e("button",{class:"btn btn-info btn-sm mt-2",onClick:je},r(U.value?"Bearbeitetes Bild anzeigen":"Original anzeigen"),1)])):x("",!0),e("div",$a,[e("button",{class:"btn btn-primary",onClick:Qe},[te.value?(o(),u("span",Fa)):x("",!0),c(" "+r(te.value?"Speichern...":"Annotation zwischenspeichern"),1)])])])])]),e("div",Ma,[e("div",Aa,[e("div",Pa,[e("h5",Ea,r(T.value?"PDF Vorschau":"Video Vorschau"),1),e("div",za,[t[36]||(t[36]=e("i",{class:"fas fa-info-circle me-2"},null,-1)),t[37]||(t[37]=e("strong",null,"Datenformat:",-1)),T.value?(o(),u("span",Ia," PDF-Dokument ("+r(Math.round((s.value?.reportMeta?.file?.length||0)/1024)||"Unbekannt")+" KB) ",1)):A.value?(o(),u("span",Ya," Video-Datei (Raw: "+r(me.value||"N/A")+" | Anonymized: "+r(fe.value||"N/A")+") ",1)):(o(),u("span",Na," Unbekanntes Format - ID: "+r(s.value?.id),1))])]),e("div",Oa,[T.value?(o(),u("div",Ua,[e("div",Ta,[e("div",Ca,[e("div",Ga,[t[40]||(t[40]=e("h6",{class:"text-center mb-3 text-danger"},[e("i",{class:"fas fa-file-pdf me-1"}),c(" Original PDF (Raw) ")],-1)),e("iframe",{src:Q.value,width:"100%",height:"700px",frameborder:"0",title:"Original PDF Vorschau"},[t[38]||(t[38]=c(" Ihr Browser unterst√ºtzt keine eingebetteten PDFs. Sie k√∂nnen die Datei ",-1)),e("a",{href:Q.value},"hier herunterladen",8,La),t[39]||(t[39]=c(". ",-1))],8,Ba),e("div",Ra,[e("small",Ka," URL: "+r(Q.value||"Nicht verf√ºgbar"),1)])])]),e("div",ja,[e("div",qa,[t[43]||(t[43]=e("h6",{class:"text-center mb-3 text-success"},[e("i",{class:"fas fa-shield-alt me-1"}),c(" Anonymisiertes PDF (Processed) ")],-1)),e("iframe",{src:ee.value,width:"100%",height:"700px",frameborder:"0",title:"Anonymisiertes PDF Vorschau"},[t[41]||(t[41]=c(" Ihr Browser unterst√ºtzt keine eingebetteten PDFs. Sie k√∂nnen die Datei ",-1)),e("a",{href:ee.value},"hier herunterladen",8,Ja),t[42]||(t[42]=c(". ",-1))],8,Ha),e("div",Wa,[e("small",Xa," URL: "+r(ee.value||"Nicht verf√ºgbar"),1)])])])]),e("div",{class:"pdf-controls mt-3 text-center"},[e("button",{class:"btn btn-outline-primary btn-sm me-2",onClick:Te},[...t[44]||(t[44]=[e("i",{class:"fas fa-download me-1"},null,-1),c(" Original herunterladen ",-1)])]),e("button",{class:"btn btn-outline-success btn-sm",onClick:Ce},[...t[45]||(t[45]=[e("i",{class:"fas fa-download me-1"},null,-1),c(" Anonymisiert herunterladen ",-1)])])])])):A.value?(o(),u("div",Za,[e("div",Qa,[e("div",en,[e("div",tn,[t[46]||(t[46]=e("h6",{class:"text-center mb-3 text-danger"},[e("i",{class:"fas fa-eye me-1"}),c(" Original Video (Raw) ")],-1)),e("video",{ref_key:"rawVideoElement",ref:R,src:me.value,controls:"",style:{width:"100%","max-height":"350px"},preload:"metadata",onError:Pe,onLoadstart:Ee,onCanplay:ze,onTimeupdate:t[9]||(t[9]=h=>he("raw"))}," Ihr Browser unterst√ºtzt dieses Video-Format nicht. ",40,an),e("div",nn,[e("small",sn," URL: "+r(me.value||"Nicht verf√ºgbar"),1)])])]),e("div",ln,[e("div",rn,[t[47]||(t[47]=e("h6",{class:"text-center mb-3 text-success"},[e("i",{class:"fas fa-shield-alt me-1"}),c(" Anonymisiertes Video (Processed) ")],-1)),e("video",{ref_key:"anonymizedVideoElement",ref:K,src:fe.value,controls:"",style:{width:"100%","max-height":"350px"},preload:"metadata",onError:Ie,onLoadstart:Ye,onCanplay:Ne,onTimeupdate:t[10]||(t[10]=h=>he("anonymized"))}," Ihr Browser unterst√ºtzt dieses Video-Format nicht. ",40,on),e("div",un,[e("small",dn," URL: "+r(fe.value||"Nicht verf√ºgbar"),1)])])])]),e("div",cn,[e("button",{class:"btn btn-outline-primary btn-sm me-2",onClick:Oe},[...t[48]||(t[48]=[e("i",{class:"fas fa-sync me-1"},null,-1),c(" Videos synchronisieren ",-1)])]),e("button",{class:"btn btn-outline-secondary btn-sm",onClick:Ue},[...t[49]||(t[49]=[e("i",{class:"fas fa-pause me-1"},null,-1),c(" Alle pausieren ",-1)])]),e("button",{class:"btn btn-outline-info btn-sm ms-2",onClick:Ge,disabled:B.value},[B.value?(o(),u("span",mn)):(o(),u("i",fn)),t[50]||(t[50]=c(" Segment-Annotation pr√ºfen ",-1))],8,vn)]),O.value&&s.value?(o(),u("div",gn,[e("div",pn,[e("div",bn,[e("div",hn,[e("div",null,[e("h6",yn,[t[51]||(t[51]=e("i",{class:"fas fa-exclamation-triangle me-2"},null,-1)),c(" Segmente zur Entfernung - Video ID: "+r(s.value.id),1)]),t[52]||(t[52]=e("small",{class:"text-muted"},' Diese Segmente wurden als "outside" klassifiziert und sollten aus dem Video entfernt werden. ',-1))]),e("div",wn,[e("div",_n,r(g.value)+" / "+r(d.value),1),e("div",Sn,[e("div",{class:"progress-bar bg-success",role:"progressbar",style:Ve({width:be.value+"%"}),"aria-valuenow":g.value,"aria-valuemin":0,"aria-valuemax":d.value},null,12,kn)]),e("small",Dn,r(be.value)+"% validiert",1)])])]),e("div",xn,[Se(Nt,{videoId:s.value.id,onSegmentValidated:Be,onValidationComplete:Le},null,8,["videoId"])])])])):x("",!0),S.value?(o(),u("div",{key:1,class:X(["alert mt-3",S.value.class])},[e("i",{class:X([S.value.icon,"me-2"])},null,2),e("strong",null,r(S.value.title)+":",1),c(" "+r(S.value.message)+" ",1),S.value.details?(o(),u("div",Vn,[e("small",null,r(S.value.details),1)])):x("",!0)],2)):x("",!0)])):(o(),u("div",$n,[t[62]||(t[62]=e("h6",null,"Debug-Informationen:",-1)),e("ul",Fn,[e("li",null,[t[53]||(t[53]=e("strong",null,"Current Item ID:",-1)),c(" "+r(s.value?.id||"Nicht verf√ºgbar"),1)]),e("li",null,[t[54]||(t[54]=e("strong",null,"SensitiveMeta ID:",-1)),c(" "+r(s.value?.sensitiveMetaId||"Nicht verf√ºgbar"),1)]),e("li",null,[t[55]||(t[55]=e("strong",null,"Is PDF:",-1)),c(" "+r(T.value),1)]),e("li",null,[t[56]||(t[56]=e("strong",null,"Is Video:",-1)),c(" "+r(A.value),1)]),e("li",null,[t[57]||(t[57]=e("strong",null,"Detected Media Type:",-1)),c(" "+r(s.value?J(_).detectMediaType(s.value):"N/A"),1)]),e("li",null,[t[58]||(t[58]=e("strong",null,"Media URL:",-1)),c(" "+r(s.value?J(_).currentMediaUrl:"N/A"),1)]),e("li",null,[t[59]||(t[59]=e("strong",null,"PDF URL:",-1)),c(" "+r(s.value?.reportMeta?.pdfUrl||"Nicht verf√ºgbar"),1)]),e("li",null,[t[60]||(t[60]=e("strong",null,"Video URL:",-1)),c(" "+r(s.value?.videoUrl||"Nicht verf√ºgbar"),1)]),e("li",null,[t[61]||(t[61]=e("strong",null,"PDF Stream URL:",-1)),c(" "+r(s.value?.pdfStreamUrl||"Nicht verf√ºgbar"),1)])])]))])])])]),e("div",Mn,[e("div",An,[e("button",{class:"btn btn-secondary",onClick:We}," √úberspringen "),e("div",Pn,[s.value&&(A.value||T.value)?(o(),u("button",{key:0,class:"btn btn-warning position-relative",onClick:tt,disabled:H.value,title:A.value?"Video-Korrektur: Maskierung, Frame-Entfernung, etc.":"PDF-Korrektur: Text-Annotation anpassen"},[t[63]||(t[63]=e("i",{class:"fas fa-edit me-1"},null,-1)),c(" "+r(A.value?"Video-Korrektur":"PDF-Korrektur")+" ",1),Re.value?(o(),u("span",zn," ! ")):x("",!0)],8,En)):x("",!0),e("button",{class:"btn btn-danger me-2",onClick:et}," Ablehnen "),e("button",{class:"btn btn-success",onClick:Ze,disabled:H.value||!ve.value,title:oe.value},[H.value?(o(),u("span",Yn)):x("",!0),c(" "+r(H.value?"Wird best√§tigt...":"Best√§tigen"),1)],8,In),!ve.value&&oe.value?(o(),u("div",Nn,[t[64]||(t[64]=e("i",{class:"fas fa-exclamation-triangle me-2"},null,-1)),t[65]||(t[65]=e("strong",null,"Best√§tigung blockiert:",-1)),c(" "+r(oe.value),1)])):x("",!0)])])])],64)):x("",!0)])])}}}),Rn=Fe(On,[["__scopeId","data-v-0e3f460f"]]);export{Rn as default};
