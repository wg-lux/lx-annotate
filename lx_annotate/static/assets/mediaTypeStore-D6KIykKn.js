import{O as V,h as y,e as d}from"./main-DethiONo.js";function f(r,i){return`${r}:${i}`}const R=V("mediaType",()=>{const r=y(null),i=y(new Map),m=y(new Map);function T(e){for(const n of e){const t=(n.mediaType??"").toLowerCase(),o=t==="pdf"?"pdf":t==="video"?"video":"unknown";o!=="unknown"&&g(n.id,o,o)}}function g(e,n,t){const o=t??n??"unknown";if(o==="unknown")return;const u=f(o,e),P=i.value.get(u),l=n==="unknown"?P??"unknown":n;if(l!=="unknown"){i.value.set(u,l);try{sessionStorage.setItem(`mediaType:${u}`,l)}catch{}}}function a(e,n){if(n){const t=f(n,e),o=i.value.get(t);if(o)return o;try{const u=sessionStorage.getItem(`mediaType:${t}`);if(console.log("from session storage:",u),u)return i.value.set(t,u),u}catch{}return"unknown"}else return"unknown"}function C(e,n){const t=a(n,e);k({id:n,scope:e,mediaType:t}),console.log(`MediaTypeStore: setCurrentByKey(${e}, ${n}) â†’ type=${t}`),console.log("CurrentItem:",r.value)}function v(e){const n=new Set;for(const t of["video","pdf","meta"]){const o=a(e,t);o&&o!=="unknown"&&n.add(o)}return[...n]}function b(e,n){const t=v(e);if(t.length===1)return t[0];if(t.length>1){if(n==="prefer-video"&&t.includes("video"))return"video";if(n==="prefer-pdf"&&t.includes("pdf"))return"pdf"}return"unknown"}function x(e,n){const t=f(e,n.id);m.value.set(t,{...n,scope:e})}function p(e,n){const t=f(e,n);return m.value.get(t)}function S(e,n){var t;return(t=p(e,n))==null?void 0:t.rawStreamUrl}function I(e,n){var t;return(t=p(e,n))==null?void 0:t.processedStreamUrl}const s={pdf:{icon:"fas fa-file-pdf text-danger",badgeClass:"bg-danger",displayName:"PDF",supportedExtensions:[".pdf"]},video:{icon:"fas fa-video text-primary",badgeClass:"bg-primary",displayName:"Video",supportedExtensions:[".mp4",".avi",".mov",".mkv",".webm"]},unknown:{icon:"fas fa-question-circle text-muted",badgeClass:"bg-secondary",displayName:"Unbekannt",supportedExtensions:[]}},c=d(()=>{const e=r.value;return e?w(e):"unknown"}),M=d(()=>c.value==="pdf"),$=d(()=>c.value==="video"),E=d(()=>c.value==="unknown"),U=d(()=>s[c.value]);function w(e){if(e.mediaType&&e.mediaType!=="unknown")return e.mediaType;if(e.scope&&e.scope!=="unknown"){const t=a(e.id,e.scope);if(console.log("Registry Value:",t),t!=="unknown")return t}if(e.filename){const t=`.${e.filename.toLowerCase().split(".").pop()||""}`;if(s.video.supportedExtensions.includes(t))return"video";if(s.pdf.supportedExtensions.includes(t))return"pdf"}const n=a(e.id);return n!=="unknown"?n:"unknown"}function k(e){r.value=e}function B(e){r.value&&(r.value={...r.value,...e})}function K(){r.value=null}function h(e){return s[e]}function L(e){const n=`.${e.toLowerCase().split(".").pop()||""}`;return Object.values(s).some(t=>t.supportedExtensions.includes(n))}function N(e){var n;return((n=s[e])==null?void 0:n.icon)||s.unknown.icon}function O(e){var n;return((n=s[e])==null?void 0:n.badgeClass)||s.unknown.badgeClass}return{currentItem:r,currentMediaType:c,isPdf:M,isVideo:$,isUnknown:E,currentMediaConfig:U,seedTypesFromOverview:T,rememberType:g,getType:a,setCurrentByKey:C,getAllTypes:v,resolveType:b,setItem:x,getItem:p,getRawStreamUrl:S,getProcessedStreamUrl:I,detectMediaType:w,setCurrentItem:k,updateCurrentItem:B,clearCurrentItem:K,getMediaTypeConfig:h,isSupportedExtension:L,getMediaTypeIcon:N,getMediaTypeBadgeClass:O}});export{R as u};
