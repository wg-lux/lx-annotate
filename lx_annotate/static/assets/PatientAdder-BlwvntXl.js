import{d as S,h as f,e as c,i as D,c as s,a as l,E as U,l as n,j as N,G as u,v as g,F as y,m as P,k as C,H as F,p,t as d,o as i,_ as B}from"./main-DethiONo.js";import{u as R}from"./patientStore-BazAFCNw.js";const T=["value"],A=["value"],G=["disabled"],Y={key:0,class:"alert alert-danger mt-2"},H={key:1,class:"alert alert-success mt-2"},j=S({__name:"PatientAdder",emits:["patient-created","cancel"],setup(q,{emit:V}){const b=V,r=R(),m=f(""),a=f({firstName:"",lastName:"",dob:null,email:"",phone:"",gender:null,center:null,patientHash:"",comments:"",isRealPerson:!0}),h=c(()=>r.genders),k=c(()=>r.centers),E=()=>{a.value={firstName:"",lastName:"",dob:null,email:"",phone:"",gender:null,center:null,patientHash:"",comments:"",isRealPerson:!0}},w=async()=>{var o,e;if(r.clearError(),m.value="",!((o=a.value.firstName)!=null&&o.trim())){r.error="Vorname ist erforderlich";return}if(!((e=a.value.lastName)!=null&&e.trim())){r.error="Nachname ist erforderlich";return}try{const t=r.formatPatientForSubmission(a.value),v=await r.createPatient(t);m.value=`Patient "${v.firstName} ${v.lastName}" wurde erfolgreich erstellt!`;try{b("patient-created",v)}catch(M){console.error("Error emitting patient-created event:",M)}E()}catch(t){r.error=t.message||"Fehler beim Erstellen des Patienten",console.error("Error creating patient:",t)}},x=()=>{try{b("cancel")}catch(o){console.error("Error emitting cancel event:",o)}};return D(async()=>{try{if(!r){console.error("PatientStore is not available");return}r.clearError(),await Promise.all([r.fetchGenders(),r.fetchCenters()])}catch(o){console.error("Error loading dropdown data:",o),(r==null?void 0:r.error)!==void 0&&(r.error="Fehler beim Laden der Auswahloptionen")}}),(o,e)=>(i(),s("div",null,[l("form",{onSubmit:U(w,["prevent"])},[e[13]||(e[13]=l("h2",null,"Patientendaten",-1)),e[14]||(e[14]=l("label",{for:"firstName"},"Vorname: *",-1)),n(l("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>a.value.firstName=t),id:"firstName",type:"text",required:"",placeholder:"Vorname eingeben"},null,512),[[u,a.value.firstName]]),e[15]||(e[15]=l("label",{for:"lastName"},"Nachname: *",-1)),n(l("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>a.value.lastName=t),id:"lastName",type:"text",required:"",placeholder:"Nachname eingeben"},null,512),[[u,a.value.lastName]]),e[16]||(e[16]=l("label",{for:"dob"},"Geburtsdatum:",-1)),n(l("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>a.value.dob=t),id:"dob",type:"date",placeholder:"YYYY-MM-DD"},null,512),[[u,a.value.dob]]),e[17]||(e[17]=l("label",{for:"email"},"E-Mail:",-1)),n(l("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>a.value.email=t),id:"email",type:"email",placeholder:"email@beispiel.de"},null,512),[[u,a.value.email]]),e[18]||(e[18]=l("label",{for:"phone"},"Telefon:",-1)),n(l("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>a.value.phone=t),id:"phone",type:"tel",placeholder:"Telefonnummer"},null,512),[[u,a.value.phone]]),l("div",null,[e[9]||(e[9]=l("label",null,"Geschlecht:",-1)),n(l("select",{"onUpdate:modelValue":e[5]||(e[5]=t=>a.value.gender=t),id:"genderSelect"},[e[8]||(e[8]=l("option",{value:""},"Bitte wählen",-1)),(i(!0),s(y,null,P(h.value,t=>(i(),s("option",{key:t.id,value:t.name},d(t.nameDe||t.name),9,T))),128))],512),[[g,a.value.gender]])]),l("div",null,[e[11]||(e[11]=l("label",{for:"centerSelect"},"Zentrum:",-1)),n(l("select",{"onUpdate:modelValue":e[6]||(e[6]=t=>a.value.center=t),id:"centerSelect"},[e[10]||(e[10]=l("option",{value:""},"Bitte wählen",-1)),(i(!0),s(y,null,P(k.value,t=>(i(),s("option",{key:t.id,value:t.name},d(t.nameDe||t.name),9,A))),128))],512),[[g,a.value.center]])]),l("div",null,[l("label",null,[n(l("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=t=>a.value.isRealPerson=t)},null,512),[[F,a.value.isRealPerson]]),e[12]||(e[12]=C(" Reale Person (abgehakt = ja, nicht abgehakt = Testdaten) ",-1))])]),e[19]||(e[19]=l("hr",null,null,-1)),l("button",{type:"submit",disabled:p(r).loading,class:"btn btn-primary"},d(p(r).loading?"Wird gespeichert...":"Patient erstellen"),9,G),l("button",{type:"button",class:"btn btn-secondary ms-2",onClick:x}," Abbrechen "),p(r).error?(i(),s("div",Y,d(p(r).error),1)):N("",!0),m.value?(i(),s("div",H,d(m.value),1)):N("",!0)],32)]))}}),I=B(j,[["__scopeId","data-v-46f3434e"]]);export{I as P};
